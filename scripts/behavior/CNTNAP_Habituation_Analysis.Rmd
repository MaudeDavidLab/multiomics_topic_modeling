---
title: "CNTNAP_Habituation_Analysis"
author: "Alexandra Phillips"
date: "`r Sys.Date()`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_float: yes
    code_folding: hide
  pdf_document:
    toc: yes
---
# Overview 
The open-field habituation test monitors the anxiety-like behavior which is considered to be reduced after repeated exposure to the increasingly familiar environment over 3 days exposure of 5 minutes each day. 

Load libraries 
```{r warning=FALSE, message = FALSE} 
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(reshape2)
library(nlme)
library(ggpubr)
library(wesanderson)
library(rstatix)
library(googledrive)
library(dplyr)
library(plyr)
library(ggplot2)

```

Load dataset and pre-work  
```{r echo=FALSE, warning=FALSE}
getwd()
hab <- read.csv("../data/behavior/Habituation_07072021.csv")

#Color pallete
sgColorPalette <- c("#84CF04","#01B5BB","#E50E63","#6D7272","#8F389E","#DF8236","#036B6B","#F1BA2F","#9F832D","#94E804" ,"#01D4DB","#FAC131","#B0B8B8","#F08C3A","#FF106E","#B948CC","#05B5B5","#CFAA3A")

#For stats
hab$Compound <- as.factor(hab$Compound)
hab <- subset(hab, Compound == "Control" | Compound == "GDC" | Compound == "UDC" | Compound == "GLUT")
my_comparisons <- list( c("Control", "UDC"), c("Control", "GDC"), c("Control", "GLUT"))

my_comparisons <- list( c("1", "2"), c("2", "3"), c("1", "3"), c("1", "4"))

#compares all stats to the control 
hab$Compound <- relevel(hab$Compound, ref = "Control")
hab$Day<- as.factor(hab$Day)
#hab$Day<- relevel(hab$Day, ref = "1")
```

```{r}
ggplot(hab, aes(x= Day, y= Total_Dist)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Distance (meters)")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+   
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Total Distance") +
  scale_x_discrete(labels=c("1", "2", "3"))
```


# Time spent in center 


Time the mouse spends in the center is a measure of anxiety indicated by either a decrease or no change over the three days testing. In neurotypical mice, we would expect to see a steady increase each day as the mouse gets more comfortable to the open space. 
```{r echo=FALSE, warning=FALSE}
center_time <- ggplot(hab, aes(x= Day, y= Center_Time)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Time")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+ 
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Time in center") +
  scale_x_discrete(labels=c("1", "2", "3"))
center_time

# ANOVA
interaction <- aov(Center_Time ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test

#active time in center
center_act <- ggplot(hab, aes(x= Day, y= Center_Amb)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Time")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+ 
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Active time in center") +
  scale_x_discrete(labels=c("1", "2", "3"))
center_act

# ANOVA
interaction <- aov(Center_Amb ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test
```
## Conclusion 


As expected, the controls do not habituate. Mice fed 5-dodecenoate differ significantlyfrom all the other groups and show the best trend for habituating and therefore, may aid in rescuing the phenotype when comparing the time spent in the center. 

Mice fed citrate do not habituate, mice fed glutamate show a possible trend for habituation, but it is not statistically significant. 


# Total distance 


Total distance traveled is a measure of exploratory behavior and non-associative learning. In neurotypical mice, we would expect the distance traveled to decreaes over the three days, the mice even may get bored and just stay in the center. 
```{r echo=FALSE, warning=FALSE}
dist <- ggplot(hab, aes(x= Day, y= Total_Dist)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Distance")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+   
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Total Distance") +
  scale_x_discrete(labels=c("1", "2", "3"))
  #scale_x_discrete(labels=c("Control n=15", "5D n=12", "GDC n= 12", "UDC n=12"))

dist

# ANOVA
interaction <- aov(Total_Dist ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test
```

## Conclusion 


The controls do not habituate between day and two and three. 5D and GDC show habituation on each day, while UDC does not decrease in day 3 which shows a lack of habituation. 5D and GDC in this measure appear to rescue the ASD-anxiogenic phenotype. 

Mice fed citrate show strong decrease between day 1 and 2, and some decrease into day 3 therefore showing a possible trend for habituating at this metric. A similar story with mice fed glutamate, there is a trend for decrease distance traveled into the 3rd day but it is not statistically significant.   


# Center zone behavior 


The number of entries into the center zone as well as the time spent per entry to the center zone can further indicate anxiety behavior. If the mice truly habituate we expect to see less entries to the center zone as well as an increase in time per entry. 
```{r echo=FALSE, warning=FALSE}

### entries to the center zone 
center_entries <- ggplot(hab, aes(x= Day, y= Center_Entries)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Entries")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+  
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Center Entries") +
  scale_x_discrete(labels=c("1", "2", "3"))
center_entries

# ANOVA
interaction <- aov(Center_Entries ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test

```

## Conclusion 



For the control and GDC groups, the number of entries compared between day 1 and 3 are significantly different and show a downward trend. Most literature, only compares the first and last day of the test. Mice fed 5D show the best trend compared to all other groups, and further show signs of habituation. 

Mice fed citrate have a decrease in the number of center entries between days 1 and 2 and somewhat in day 3, however given they spend less time in the center overall three days this does not seem to indicate habituation. Mice fed glutamate show no trend. 

# Ambulatory time per day 


Ambulatory/active time can support the claims of habituation, as we would expect the active time to decrease over three days, as they habituate. 
```{r echo=FALSE, warning=FALSE}
amb_total <- ggplot(hab, aes(x= Day, y= Total_Amb)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Time")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+ 
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Total ambulatory time") +
  scale_x_discrete(labels=c("1", "2", "3"))
amb_total

# ANOVA
interaction <- aov(Total_Amb ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test

amb_center <- ggplot(hab, aes(x= Day, y= Center_Amb)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Time")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+  
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Center ambulatory time") +
  scale_x_discrete(labels=c("1", "2", "3"))
amb_center

# ANOVA
interaction <- aov(Center_Amb ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test


### Comparing total ambulatory time to total distance traveled
ggarrange(dist, amb_total, nrow= 1, common.legend = TRUE)
```

## Conclusion 



The controls as well as mice fed 5D habituate in terms of ambulatory time. Mice fed GDC, UDC, citrate and glutamate show a decrease between the first day but not in the second which indicates they do not habituate. 




# Comparing the days between compounds

```{r echo=FALSE, warning=FALSE}
comp <- ggplot(hab, aes(x= Compound, y= Center_Time)) + 
  geom_boxplot(aes(fill= Compound))+
  xlab("Metabolite") + ylab("Time spent in the center")+
  scale_fill_manual(values=sgColorPalette)+
  geom_jitter()+  
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  facet_grid(.~ Day)+
   ggtitle("Time spent in the center")+ 
  theme(legend.position = "none")
comp


comp_1 <- ggplot(hab, aes(x= Compound, y= Total_Dist)) + 
  geom_boxplot(aes(fill= Compound))+
  xlab("Metabolite") + ylab("Total distance (meters)")+
  scale_fill_manual(values=sgColorPalette)+
  geom_jitter()+  
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  facet_grid(.~ Day)+
   ggtitle("Total distance comparison between each day")+ 
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  theme(legend.position = "none")
comp_1

interaction <- aov(Total_Dist ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test
```

## Conclusion 



5D has a small amount of variation compared to other compounds for each of the three days. 


# Center time per entry 
```{r}
hab$cen_time_ent <- hab$Center_Time / hab$Center_Entries

ggplot(hab, aes(x= Day, y= cen_time_ent)) + 
  geom_boxplot(aes(fill=Compound))+
  scale_fill_manual(values=sgColorPalette)+
  xlab("Day") + ylab("Seconds")+
  facet_wrap(~Compound, nrow = 1)+
  geom_jitter()+ 
  stat_compare_means(comparisons = my_comparisons, method = "wilcox.test")+
  ggtitle("Time per center entry") +
  scale_x_discrete(labels=c("Control n=15", "5D n=12", "BL6 n=12", "CIT n=9", "GDC n= 12","GLUT n=8", "UDC n=12"))

# ANOVA
interaction <- aov(cen_time_ent ~ Compound, data = hab)
summary(interaction)

tukey.test <- TukeyHSD(interaction)
tukey.test
```

## Conclusion 


No significant difference between any of the compounds... best possible trend for spending more time per entry over the three days is 5D. Mice fed citrate and glutamate show some signs of habituation but when put together are not as strong compared to 5D.  